{{!-- Sidebar Navigation --}}
<div class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <div class="sidebar-brand">
            <i class="fas fa-shield-alt"></i>
            <span class="sidebar-title">CryptInsa</span>
        </div>
        <button class="sidebar-close" id="sidebarClose">
            <i class="fas fa-times"></i>
        </button>
    </div>
    
    <div class="sidebar-content">
        <nav class="sidebar-nav">
            <ul class="sidebar-menu">
                <li class="menu-item">
                    <a href="/" class="menu-link">
                        <i class="fas fa-home"></i>
                        <span>Accueil</span>
                    </a>
                </li>
                
                <li class="menu-item">
                    <a href="/about_us" class="menu-link">
                        <i class="fas fa-users"></i>
                        <span>Notre Équipe</span>
                    </a>
                </li>
                
                <li class="menu-item has-submenu">
                    <a href="#" class="menu-link submenu-toggle">
                        <i class="fas fa-tools"></i>
                        <span>Outils Crypto</span>
                        <i class="fas fa-chevron-down submenu-arrow"></i>
                    </a>
                    <ul class="submenu">
                        <li><a href="/cesar" class="submenu-link">
                            <i class="fas fa-key"></i>
                            Chiffre César
                        </a></li>
                        <li><a href="/vigenere" class="submenu-link">
                            <i class="fas fa-lock"></i>
                            Chiffre Vigenère
                        </a></li>
                        <li><a href="/substitution" class="submenu-link">
                            <i class="fas fa-exchange-alt"></i>
                            Substitution
                        </a></li>
                        <li><a href="/test" class="submenu-link">
                            <i class="fas fa-chart-bar"></i>
                            Analyse Fréquence
                        </a></li>
                    </ul>
                </li>
                
                <li class="menu-item">
                    <a href="/substitution_attaque" class="menu-link">
                        <i class="fas fa-search"></i>
                        <span>Cryptanalyse</span>
                    </a>
                </li>
                
                <li class="menu-item">
                    <a href="/help" class="menu-link">
                        <i class="fas fa-question-circle"></i>
                        <span>Aide</span>
                    </a>
                </li>
            </ul>
        </nav>
        
        <div class="sidebar-footer">
            <div class="crypto-info">
                <div class="info-item">
                    <i class="fas fa-shield-check"></i>
                    <span>Sécurisé</span>
                </div>
                <div class="info-item">
                    <i class="fas fa-graduation-cap"></i>
                    <span>Éducatif</span>
                </div>
            </div>
        </div>
    </div>
</div>

{{!-- Sidebar Overlay --}}
<div class="sidebar-overlay" id="sidebarOverlay"></div>

{{!-- Sidebar Toggle Button --}}
<button class="sidebar-toggle" id="sidebarToggle">
    <i class="fas fa-bars"></i>
</button>

{{!-- Sidebar Styles --}}
<style>
/* ===== SIDEBAR NAVIGATION ===== */
.sidebar {
    position: fixed;
    top: 0;
    left: -300px;
    width: 300px;
    height: 100vh;
    background: var(--bg-card);
    border-right: 1px solid var(--border-color);
    z-index: 1000;
    transition: left 0.3s ease;
    overflow-y: auto;
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
}

.sidebar.active {
    left: 0;
}

.sidebar-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1.5rem;
    border-bottom: 1px solid var(--border-color);
    background: var(--bg-darker);
}

.sidebar-brand {
    display: flex;
    align-items: center;
    gap: 0.8rem;
}

.sidebar-brand i {
    font-size: 1.5rem;
    color: var(--primary-color);
}

.sidebar-title {
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--text-primary);
}

.sidebar-close {
    background: none;
    border: none;
    color: var(--text-secondary);
    font-size: 1.2rem;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 4px;
    transition: all 0.3s ease;
}

.sidebar-close:hover {
    background: var(--primary-color);
    color: var(--bg-dark);
}

.sidebar-content {
    padding: 1rem 0;
    height: calc(100vh - 80px);
    display: flex;
    flex-direction: column;
}

.sidebar-nav {
    flex: 1;
}

.sidebar-menu {
    list-style: none;
    padding: 0;
    margin: 0;
}

.menu-item {
    margin-bottom: 0.2rem;
}

.menu-link {
    display: flex;
    align-items: center;
    padding: 0.8rem 1.5rem;
    color: var(--text-secondary);
    text-decoration: none;
    transition: all 0.3s ease;
    position: relative;
}

.menu-link:hover {
    background: rgba(0, 255, 136, 0.1);
    color: var(--primary-color);
}

.menu-link.active {
    background: rgba(0, 255, 136, 0.15);
    color: var(--primary-color);
    border-right: 3px solid var(--primary-color);
}

.menu-link i {
    width: 20px;
    margin-right: 0.8rem;
    font-size: 1rem;
}

.menu-link span {
    font-weight: 500;
}

/* Submenu */
.has-submenu .submenu-arrow {
    margin-left: auto;
    transition: transform 0.3s ease;
}

.has-submenu.open .submenu-arrow {
    transform: rotate(180deg);
}

.submenu {
    list-style: none;
    padding: 0;
    margin: 0;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
    background: var(--bg-darker);
}

.has-submenu.open .submenu {
    max-height: 200px;
}

.submenu-link {
    display: flex;
    align-items: center;
    padding: 0.6rem 1.5rem 0.6rem 3rem;
    color: var(--text-muted);
    text-decoration: none;
    font-size: 0.9rem;
    transition: all 0.3s ease;
}

.submenu-link:hover {
    background: rgba(0, 255, 136, 0.08);
    color: var(--primary-color);
}

.submenu-link i {
    width: 16px;
    margin-right: 0.6rem;
    font-size: 0.8rem;
}

/* Sidebar Footer */
.sidebar-footer {
    padding: 1rem 1.5rem;
    border-top: 1px solid var(--border-color);
    background: var(--bg-darker);
}

.crypto-info {
    display: flex;
    gap: 1rem;
}

.info-item {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    font-size: 0.8rem;
    color: var(--text-muted);
}

.info-item i {
    color: var(--primary-color);
}

/* Sidebar Overlay */
.sidebar-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 999;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.sidebar-overlay.active {
    opacity: 1;
    visibility: visible;
}

/* Sidebar Toggle Button */
.sidebar-toggle {
    position: fixed;
    top: 8px;
    left: 20px;
    width: 50px;
    height: 50px;
    background: var(--primary-color);
    border: none;
    border-radius: 8px;
    color: var(--bg-dark);
    font-size: 1.2rem;
    cursor: pointer;
    z-index: 1001;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0, 255, 136, 0.3);
}

.sidebar-toggle:hover {
    background: var(--primary-dark);
    transform: scale(1.05);
}

/* Responsive */
@media (max-width: 768px) {
    .sidebar {
        width: 280px;
        left: -280px;
    }
    
    .sidebar-toggle {
        top: 15px;
        left: 15px;
        width: 45px;
        height: 45px;
    }
}
</style>

{{!-- Sidebar JavaScript --}}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const sidebar = document.getElementById('sidebar');
    const sidebarToggle = document.getElementById('sidebarToggle');
    const sidebarClose = document.getElementById('sidebarClose');
    const sidebarOverlay = document.getElementById('sidebarOverlay');
    const submenuToggles = document.querySelectorAll('.submenu-toggle');

    // Toggle sidebar
    function toggleSidebar() {
        sidebar.classList.toggle('active');
        sidebarOverlay.classList.toggle('active');
        document.body.style.overflow = sidebar.classList.contains('active') ? 'hidden' : '';
    }

    // Close sidebar
    function closeSidebar() {
        sidebar.classList.remove('active');
        sidebarOverlay.classList.remove('active');
        document.body.style.overflow = '';
    }

    // Event listeners
    sidebarToggle.addEventListener('click', toggleSidebar);
    sidebarClose.addEventListener('click', closeSidebar);
    sidebarOverlay.addEventListener('click', closeSidebar);

    // Submenu toggle
    submenuToggles.forEach(toggle => {
        toggle.addEventListener('click', function(e) {
            e.preventDefault();
            const menuItem = this.parentElement;
            menuItem.classList.toggle('open');
        });
    });

    // Close sidebar on escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && sidebar.classList.contains('active')) {
            closeSidebar();
        }
    });

    // Set active link based on current page
    const currentPath = window.location.pathname;
    const menuLinks = document.querySelectorAll('.menu-link, .submenu-link');
    
    menuLinks.forEach(link => {
        if (link.getAttribute('href') === currentPath) {
            link.classList.add('active');
            // Open parent submenu if it's a submenu link
            const parentSubmenu = link.closest('.has-submenu');
            if (parentSubmenu) {
                parentSubmenu.classList.add('open');
            }
        }
    });
});
</script>
